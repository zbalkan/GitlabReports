using System.Collections.Generic;
using System.Text.Json.Serialization;

namespace SemgrepReports.Models
{
    public class Vulnerability
    {
        [JsonPropertyName("id")]
        public string Id { get; set; }

        [JsonPropertyName("category")]
        public string Category { get; set; }

        [JsonPropertyName("name")]
        public string Name { get; set; }

        [JsonPropertyName("message")]
        public string Message { get; set; }

        [JsonPropertyName("description")]
        public string Description { get; set; }

        [JsonPropertyName("cve")]
        public string Cve { get; set; }

        [JsonPropertyName("severity")]
        public string Severity { get; set; }

        [JsonPropertyName("confidence")]
        public string Confidence { get; set; }

        [JsonPropertyName("raw_source_code_extract")]
        public string RawSourceCodeExtract { get; set; }

        [JsonPropertyName("scanner")]
        public Scanner Scanner { get; set; }

        [JsonPropertyName("location")]
        public Location Location { get; set; }

        [JsonPropertyName("identifiers")]
        public List<Identifier> Identifiers { get; set; }

        public int Priority => Severity switch
        {
            "Critical" => 1,
            "High" => 2,
            "Medium" => 3,
            "Low" => 4,
            _ => 0,
        };
    }
}
